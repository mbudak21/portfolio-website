---
import "../styles/global.css";
import ThemeSwitcher from "../components/ThemeSwitcher.astro";
import Navbar from "../components/Navbar.astro";
import Nvim from "../components/Nvim.astro";
import GlassButton from "../components/Glass-btn.astro";

const pageTitle = "~/portfolio"
const links = [
  { href: "/", label: "Home" },
  { href: "/projects", label: "Projects" },
  { href: "/blog", label: "Blog" },
  { href: "/contact", label: "Contact" },
];
---

<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" type="image/svg+xml" href="/favicon.ico" />
		<meta name="viewport" content="width=device-width" />
		<meta name="generator" content={Astro.generator} />
		<title>{pageTitle}</title>
	</head>
	<body>
    <Navbar {links} />
		<canvas id="bg-canvas"></canvas>
		<!-- <ThemeSwitcher/> -->
		<!-- <Nvim/> -->
    
    <div class="wrap">
      <h1 class="center">Clean Code. Systems. Graphics.</h1>
      <p class="muted center">I build fast, minimal software and occasional pretty pixels.</p>
    </div>

    <div class="wrap center">
      <GlassButton as="a" href={links[1].href} text="View Projects"/>
    </div>

    <div class="wrap">
      <h2>About</h2>
      <p class="soft-p">
Every few months I wonder if I even like programming, or if I just hate not understanding things I’ll never use.
Then I spend four hours why my latest wayland config got nuked. <br> <br>
Maybe that’s what passion is. Or maybe it’s brain damage. Hard to say.  <br> <br> <br> <br>

The rest of the website is in development, I'll push it in a few days. <br>

        <!-- I'm Murat, and I absolutely love pizza. <br> -->
        <!-- And this website, what started as a `Hire Me!` showcase is one of the ways I want to express myself. <br>
        So if you are here to be impressed, well, I'm here to deliver. -->
      </p>
    </div>

	</body>
</html>

<script>
  import * as THREE from 'three';
  import { OrbitControls } from 'three/addons/controls/OrbitControls.js';

  export class ThreeRenderer{
    private canvas!: HTMLCanvasElement;
    private renderer!: THREE.WebGLRenderer;
    private scene!: THREE.Scene;
    private camera!: THREE.PerspectiveCamera;
    private cube!: THREE.Mesh;
    controls!: OrbitControls;
    torusMesh!: THREE.Mesh<THREE.TorusKnotGeometry, THREE.MeshStandardMaterial, THREE.Object3DEventMap>;

    constructor(canvasSelector = '#bg-canvas'){
      let canvas = document.querySelector(canvasSelector) as HTMLCanvasElement | null;
      if (!canvas) {
        console.error(`Couldn't find canvas in DOM: "${canvasSelector}"`);
        return;
      }
      this.canvas = canvas;

      this.init();
      this.animate = this.animate.bind(this); // bind once
      this.animate();

      window.addEventListener('resize', () => this.onResize());
    }

    createScene(){
      this.torusMesh = new THREE.Mesh(
        new THREE.TorusKnotGeometry( 1, 0.4, 128, 128, 1, 3 ),
        new THREE.MeshStandardMaterial()
      );
      this.scene.add(this.torusMesh);

      const light = new THREE.PointLight(0xffffff, 3);
      light.position.set(5, 5, -5);
      this.scene.add(light);
    }

    init() {
      // Scene
      this.scene = new THREE.Scene();

      // Camera
      this.camera = new THREE.PerspectiveCamera(
        75,
        window.innerWidth / window.innerHeight,
        0.1,
        1000
      );
      this.camera.position.set( 0.0, 0.0, - 6.0 );

      // Renderer
      this.renderer = new THREE.WebGLRenderer({
        canvas: this.canvas,
        antialias: true,
      });
      this.renderer.setSize(window.innerWidth, window.innerHeight);
      this.renderer.setPixelRatio(window.devicePixelRatio);
      this.renderer.setClearColor(0x000000);

      this.controls = new OrbitControls( this.camera, this.renderer.domElement );


      this.createScene();
      // this.animate();

    }

    animate() {
      requestAnimationFrame(this.animate);

      this.torusMesh.rotation.x += 0.01;
      this.torusMesh.rotation.y += 0.01;
      this.controls.update();

      this.renderer.render(this.scene, this.camera);
    }

    onResize() {
      this.camera.aspect = window.innerWidth / window.innerHeight;
      this.camera.updateProjectionMatrix();
      this.renderer.setSize(window.innerWidth, window.innerHeight);
    }
  }

  
  window.addEventListener('DOMContentLoaded', () => {
    new ThreeRenderer('#bg-canvas');
  });
</script>