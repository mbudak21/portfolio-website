---
// Navbar.astro
export interface Link { href: string; label: string }
const { links = [
  { href: "/", label: "Home" },
  { href: "/projects", label: "Projects" },
  { href: "/blog", label: "Blog" },
  { href: "/contact", label: "Contact" },
] }: { links?: Link[] } = Astro.props;
---

<style>
  :root { --nav-h: 56px; }

  .nav {
    height: var(--nav-h);
    display: flex; align-items: center; justify-content: space-between;
    background: var(--surface-color, var(--bg-color));
    color: var(--font-color); padding: 0 1rem; position: sticky; top: 0;
    border-bottom: 1px solid var(--border-color);
    backdrop-filter: saturate(1.2) blur(6px);
  }

  .brand {
    font-weight: 700; letter-spacing: .4px;
    color: var(--heading-color); text-decoration: none;
  }

  .links {
    display: none; gap: 1rem; align-items: center;
  }

  .link {
    position: relative; text-decoration: none; color: var(--font-color);
    padding: .4rem .2rem; font-weight: 600;
  }
  /* animated underline */
  .link::after {
    content: ""; position: absolute; left: 0; bottom: -2px; height: 2px; width: 100%;
    background: var(--primary-color);
    transform: scaleX(0); transform-origin: left; transition: transform .25s ease;
  }
  .link:hover::after, .link:focus-visible::after { transform: scaleX(1); }

  /* hamburger */
  .burger {
    width: 34px; height: 28px; display: grid; place-items: center;
    border: 0; background: transparent; cursor: pointer;
  }
  .bar, .bar::before, .bar::after {
    display: block; width: 22px; height: 2px; background: var(--font-color);
    transition: transform .25s ease, opacity .2s ease;
    content: "";
  }
  .bar { position: relative; }
  .bar::before { position: absolute; transform: translateY(-7px); }
  .bar::after  { position: absolute; transform: translateY(7px); }
  .burger[aria-expanded="true"] .bar   { transform: rotate(45deg); }
  .burger[aria-expanded="true"] .bar::before { opacity: 0; }
  .burger[aria-expanded="true"] .bar::after  { transform: rotate(-90deg); }

  /* mobile drawer */
  .drawer {
    position: fixed; inset: var(--nav-h) 0 auto 0; background: var(--bg-color);
    border-top: 1px solid var(--border-color);
    display: grid; gap: .4rem; padding: .8rem 1rem;
    max-height: 0; overflow: clip; opacity: 0;
    transition: max-height .3s ease, opacity .2s ease;
  }
  .drawer.open { max-height: 50vh; opacity: 1; }
  .drawer a { padding: .6rem 0; text-decoration: none; color: var(--font-color); }

  /* desktop */
  @media (min-width: 768px) {
    .burger { display: none; }
    .links { display: flex; }
    .drawer { display: none; }
  }

  @media (prefers-reduced-motion: reduce) {
    .link::after, .bar, .bar::before, .bar::after, .drawer { transition: none; }
  }
</style>

<nav class="nav" aria-label="Main">
  <a class="brand" href="/">mbudak21.com</a>

  <div class="links" role="menubar">
    {links.map(l => <a class="link" role="menuitem" href={l.href}>{l.label}</a>)}
  </div>

  <button class="burger" aria-label="Menu" aria-expanded="false">
    <span class="bar"></span>
  </button>
</nav>

<div class="drawer" id="drawer">
  {links.map(l => <a href={l.href}>{l.label}</a>)}
</div>

<script is:inline>
  const btn = document.querySelector('.burger');
  const drawer = document.getElementById('drawer');
  btn?.addEventListener('click', () => {
    const open = btn.getAttribute('aria-expanded') === 'true';
    btn.setAttribute('aria-expanded', String(!open));
    drawer?.classList.toggle('open', !open);
  });
  // close on route change (Astro SPA/partial hydration not needed here, safe default)
  window.addEventListener('pageshow', () => {
    btn?.setAttribute('aria-expanded', 'false');
    drawer?.classList.remove('open');
  });
</script>
