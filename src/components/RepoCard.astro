---
export interface Props {
  name: string;
  description: string;
  href: string;
  language?: string;
  stars?: number;
  homepageUrl?: string;
}

const { name, description, href, language, stars, homepageUrl } = Astro.props;
const lang_arr = language ? language.split(",").map((s: string) => s.trim()) : [];

const ICONS = {
  repo: `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 22h14a2 2 0 0 0 2-2V7.5L14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2z"></path><polyline points="14 2 14 8 20 8"></polyline></svg>`,
  star: `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon></svg>`,
  external: `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg>`,
};

// Github Colors
const langColors: Record<string, string> = {
  JavaScript: "#f1e05a",
  TypeScript: "#3178c6",
  Python: "#3572A5",
  Vue: "#41b883",
  Svelte: "#ff3e00",
  Astro: "#ff5a03",
  HTML: "#e34c26",
  CSS: "#563d7c",
  SCSS: "#c6538c",
  Rust: "#dea584",
  Go: "#00ADD8",
  Java: "#b07219",
  C: "#555555",
  "C++": "#f34b7d",
  "C#": "#178600",
  PHP: "#4F5D95",
  Ruby: "#701516",
  Swift: "#F05138",
  Kotlin: "#A97BFF",
  Dart: "#00B4AB",
  Lua: "#000080",
  Shell: "#89e051"
};
---

<article class="card glass">
  <header class="card-header">
    <div class="repo-name">
      <Fragment set:html={ICONS.repo} />
        <h3>
          <a href={href} target="_blank" rel="noopener noreferrer" class="main-link">
            {name}
            <span class="absolute-inset" aria-hidden="true"></span>
          </a>
        </h3>
    </div>
    {homepageUrl && (
      <a href={homepageUrl} target="_blank" rel="noopener noreferrer" class="external-link" aria-label="Canlı siteyi aç">
        <Fragment set:html={ICONS.external} />
      </a>
    )}
  </header>

  <p class="description">{description}</p>

  <footer class="card-footer">
    <!-- {language && (
      <div class="footer-item">
        <span class="language-dot" style={`background-color: ${dotColor};`}></span>
        <span>{language}</span>
      </div>
    )} -->
    {lang_arr.map((lang) => {
      const dotColor = langColors[lang] ? langColors[lang] : 'var(--primary-color, #ccc)';
      return (
        <div class="footer-item">
          <span class="language-dot" style={`background-color: ${dotColor};`}></span>
          <span>{lang}</span>
        </div>
      )
    })}
    {stars !== undefined && (
      <div class="footer-item">
        <Fragment set:html={ICONS.star} />
        <span>{stars}</span>
      </div>
    )}
  </footer>
</article>


<style>
  .card {
    text-decoration: none;
    color: var(--font-color);
    display: block;
    height: 100%;

    border: 1px solid var(--border-color);
    border-radius: 12px;
    padding: 1.5rem;
    height: 100%;
    
    display: flex;
    flex-direction: column;
    justify-content: space-between;

    transition: all 0.25s ease;
  }

  .card:hover {
    transform: translateY(-4px);
    border-color: var(--highlight-color);
    border-width: 2px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
  }

  .card-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1rem;
  }

  .repo-name {
    display: flex;
    align-items: center;
    gap: 0.75rem;
  }

  .repo-name h3 {
    margin: 0;
    font-size: 1.25rem;
    color: var(--heading-color);
  }

  .external-link {
    color: var(--secondary-color);
    transition: color 0.2s ease;
  }
  .external-link:hover {
    color: var(--primary-color);
  }

  .description {
    font-size: 0.95rem;
    color: var(--font-color);
    opacity: 0.9;
    line-height: 1.6;
    margin-bottom: 1.5rem;
    flex-grow: 1; 
  }

  .card-footer {
    display: flex;
    align-items: center;
    gap: 1.5rem;
    font-size: 0.85rem;
    color: var(--secondary-color);
  }

  .footer-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .language-dot {
    width: 10px;
    height: 10px;
    border-radius: 50%;
  }

  .footer-item svg {
    stroke: var(--secondary-color);
  }
</style>